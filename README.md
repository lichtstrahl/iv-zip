# iv-zip
Проект архиватора

# Сборка
Проект собирается через gradle-таску: `:shadowJar`

# Запуск
Два режима работы: ZIP, UNZIP

## ZIP
Пример команд:  
1. `java -jar IvZip**.jar ./file1 ./file2 ./dir1 > out.zip` - переданные файлы сожмутся и упакуются в архив out.zip  
2. `java -jar IvZip**.jar --non-pipe ./file1 ./file2 ./dir1` - сжатие без использование pipe. Все переданные файлы сожмутся в архив **output.zip** в текущей папке. Флаг обязательно передаётся первым параметром. 

## UNZIP
Пример команды:
1. `java -jar IvZip**>jar < out.zip` - файлы распакуются в текущую папку

### Проблемы с многопотоком
В коде используется Stream API. Для обработки каждого переданного аргумента, а потом и для каждого дочернего файла, если это директория.  
Пробовал использовать `.stream().parallel()` в обоих случаях. Да, файлы стали формально обрабатываться в несколько потоков, но выигрыша по времени не было. Поэтому убрал, чтобы код стал проще.  
Скорее всего проблема в том, что единственная тяжелая операция - запись данных в архив должна выполняться синхронно. Поэтому все равно все потоки блокируются и ждут, когда освободится ресурс, отвечающий за запись данных в архив.  

